<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Yuji+Mai&display=swap" rel="stylesheet">
<title>makimono</title>
<style>
  :root{
        --bg: #0e0f12;
      --fg: #ffffff;
        --accent: #b28c52;
    }
  
  html,body {
    max-width: 100vw;
    max-height: 100vh;
    margin:0;
    background-color: #000;
  }
   
  .wrap{
    min-height:95%;
    display:grid;
    place-items:center;
    padding: 24px;
  }

  /* コンポーネント領域（相対配置） */
  .scroll-stage{
    position:relative;
    /* width:min(92vw, 820px); */
    /* 高さは開いた時の見た目に合わせて可変 */
  }

  /* 画像は横幅フィット */
  .scroll-image{
    width:100%;
    height:auto;
    display:block;
    user-select:none;
    -webkit-user-drag: none;
  }

  /* 初期：閉じた巻物をボタンとして扱う（アクセシビリティ） */
  .scroll-button{
    all: unset; /* buttonのデフォルトスタイルを消す */
    cursor: pointer;
    display:block;
    margin-top: 40%;
  }
  .scroll-button:focus-visible{
    outline: 3px solid #5aa9ff;
  }

  /* 開いた巻物は最初は非表示 */
  #openImg{ display:none; }
    /* ▼ 開いた巻物が下からせり上がる表示 */
    @keyframes revealUp{
    from{ clip-path: inset(100% 0 0 0); -webkit-clip-path: inset(100% 0 0 0); }
    to  { clip-path: inset(0 0 0 0);     -webkit-clip-path: inset(0 0 0 0); }
    }
    #openImg.reveal{
    /* まず見せる */
    display:block;
    /* 画像の下端から徐々に露出 */
    clip-path: inset(100% 0 0 0);
    -webkit-clip-path: inset(100% 0 0 0);
    animation: revealUp 900ms cubic-bezier(.2,.7,.2,1) forwards;
    }

    /* モーション軽減時は即時表示 */
    @media (prefers-reduced-motion: reduce){
    #openImg.reveal{
        animation: none;
        clip-path: inset(0);
        -webkit-clip-path: inset(0);
    }
    }


  /* テキストオーバーレイ（最初は透明＆非表示） */
  .overlay{
    position:absolute;
    inset:0;
    display:flex;
    align-items:center;
    justify-content:center;
    pointer-events:none; /* クリックは下に通す */
    padding: 8%;
    /* 文字を右90度回転 */
    transform: rotate(90deg);
    opacity:0;
  }
  /* ▼ 既存の .overlay.show に「opacity:1」を明記（順序は .overlay 定義の“後”に置く） */
.overlay.show{
  opacity: 1;              /* ← 明示上書き */
  animation: fadeUp 700ms cubic-bezier(.2,.7,.2,1) forwards;
  z-index: 2;              /* ← 念のため前面に */
}


  /* フェードインアニメーション */
  @keyframes fadeUp{
    from{ opacity:0; transform: translateX(8px) rotate(90deg); }
    to{   opacity:1; transform: translateX(0)   rotate(90deg); }
  }

  /* テキストの見た目（パーチメント上で視認性を確保） */
  .oracle{
    font-size: clamp(10px, 7vw, 72px);
    font-weight: 800;
    letter-spacing: .08em;
    color: #2b2112;
    filter: drop-shadow(0 3px 12px rgba(0,0,0,.25));
    text-align:center;
    line-height:1.2;
    font-family: "Yuji Mai", serif;
  }

  /* 小さめ画面での余白最適化 */
  @media (max-width:480px){
    .overlay{ padding: 4%; }
  }

  /* モーション軽減への配慮 */
  @media (prefers-reduced-motion: reduce){
    .overlay.show{ animation: none; opacity:1; }
  }

  
</style>
</head>
<body>
 <main class="wrap">
    <section class="scroll-stage" aria-live="polite">
      <!-- 1クリックめ：このボタン（閉じた巻物画像）を押す -->
      <button id="scrollBtn" class="scroll-button" aria-label="巻物を開く">
        <img id="closedImg" class="scroll-image" alt="閉じた巻物"
             src="tool3/close.png">
      </button>

      <!-- クリック後に表示：開いた巻物画像 -->
      <img id="openImg" class="scroll-image" alt="開いた巻物"
           src="tool3/open.png">

      <!-- テキストオーバーレイ -->
      <div id="overlay" class="overlay" aria-hidden="true">
        <div id="oracleText" class="oracle"></div>
      </div>
    </section>

  </main>

<script>
  // ランダム表示する文言パターン（必要に応じて編集可）
  const MESSAGES = [
    "今日一番早く起きた人",
    "今日一番遅く起きた人",
    "一番最近誕生日だった人",
    "次に誕生日が来る人",
    "一番最近旅行した人",
    "スマホの電池残量が一番低い/高い人",
    "じゃんけん",
    "指パッチンの音が一番大きい人",
    "一番赤色のものを身に着けている人",
    "靴下の色が奇抜な人"
  ];

  const btn = document.getElementById('scrollBtn');
  const closed = document.getElementById('closedImg');
  const open = document.getElementById('openImg');
  const overlay = document.getElementById('overlay');
  const textEl = document.getElementById('oracleText');
  const hint = document.getElementById('hint');
  const koto = new Audio("tool3/koto.mp3");
  koto.volume = 0.5;

  // Enter/Spaceでも開けるようbuttonを活用
  btn.addEventListener('click', openScroll, { once: true });

  function openScroll(){
    koto.play();
    // 要素を都度取得し、なければ生成してから使う
    const overlay = document.getElementById('overlay');
    let textEl = document.getElementById('oracleText');

    if (!overlay) {
        console.error('overlay (#overlay) が見つかりません。HTMLのIDを確認してください。');
        return;
    }
    if (!textEl) {
        textEl = document.createElement('div');
        textEl.id = 'oracleText';
        textEl.className = 'oracle';
        overlay.appendChild(textEl);
    }

    // 画像の切替（閉→開アニメ開始）
    closed.style.display = 'none';
    open.style.display = 'block';
    open.classList.add('reveal'); // 下から表示アニメ

    // ランダム文言決定（先に用意だけしておく）
    const pick = MESSAGES[Math.floor(Math.random()*MESSAGES.length)];
    textEl.textContent = pick;

    // ボタン無効化とヒント更新
    btn.setAttribute('aria-hidden', 'true');
    btn.style.display = 'none';
  
    // 巻物のアニメ終了後に文字を表示
    open.addEventListener('animationend', () => {
            overlay.setAttribute('aria-hidden', 'false');
            overlay.classList.add('show'); // 既存のテキストふわっと表示
        }, { once: true });
    }


</script>
</body>
</html>